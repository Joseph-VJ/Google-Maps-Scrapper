{% extends "base.html" %}

{% block title %}Chennai Guided Scraper ¬∑ Google Maps Scraper{% endblock %}

{% block content %}
<section class="page-hero page-hero--compact" aria-labelledby="chennai-title">
    <div class="page-hero__content">
        <span class="hero-eyebrow">Regional automation</span>
        <h1 id="chennai-title">Direct neighbourhood scraping for Chennai</h1>
        <p class="mb-0">Target multiple districts in a single run with cache-aware resume tools, precise business filters, and responsive layout built for fast iteration.</p>
        <div class="hero-actions">
            <a class="btn btn-primary" href="#chennaiForm" data-scroll-target="#chennaiForm">
                <i class="fa-solid fa-sliders"></i>
                <span class="ms-2">Configure Chennai run</span>
            </a>
            <a class="btn btn-soft" href="{{ url_for('index') }}">
                <i class="fa-solid fa-magnifying-glass-location"></i>
                <span class="ms-2">Standard scraping</span>
            </a>
        </div>
    </div>
    <div class="hero-aside" aria-label="Chennai workflow highlights">
        <div class="hero-aside__card">
            <strong class="d-block mb-2">Designed for hyperlocal coverage</strong>
            <ul class="mb-0 ps-3">
                <li>Batch-select trusted neighbourhood groups.</li>
                <li>Track total and selected areas as you go.</li>
                <li>Resume cached sessions with a single click.</li>
            </ul>
        </div>
    </div>
</section>

<div class="guided-layout">
    <div class="guided-layout__primary">
        <form method="POST" action="{{ url_for('start_chennai_scraping') }}" id="chennaiForm" class="guided-form" novalidate tabindex="-1">
            <section class="form-section" aria-labelledby="business-focus-heading">
                <header class="section-header">
                    <div>
                        <p class="section-kicker">Step 1</p>
                        <h2 id="business-focus-heading" class="section-title">Tune your business focus</h2>
                        <p class="section-meta mb-0">Pick a ready-made category or roll with a custom keyword.</p>
                    </div>
                </header>
                <div class="field-grid field-grid--two">
                    <div class="field-group">
                        <label for="business_type" class="field-label">
                            <span><i class="fa-solid fa-store me-1"></i> Business category</span>
                            <span class="tooltip-icon" role="img" data-bs-toggle="tooltip" title="Select a preset to speed through configuration or choose custom to supply your own keyword." aria-hidden="true">?</span>
                        </label>
                        <select class="form-select" id="business_type" name="business_type" onchange="toggleCustomKeyword()" required>
                            <option value="">Select business type</option>
                            <option value="restaurants">Restaurants</option>
                            <option value="hotels">Hotels</option>
                            <option value="hospitals">Hospitals</option>
                            <option value="schools">Schools</option>
                            <option value="banks">Banks</option>
                            <option value="atms">ATMs</option>
                            <option value="petrol pumps">Petrol Pumps</option>
                            <option value="pharmacies">Pharmacies</option>
                            <option value="shopping malls">Shopping Malls</option>
                            <option value="supermarkets">Supermarkets</option>
                            <option value="gyms">Gyms</option>
                            <option value="beauty salons">Beauty Salons</option>
                            <option value="car dealers">Car Dealers</option>
                            <option value="real estate agents">Real Estate Agents</option>
                            <option value="electronics stores">Electronics Stores</option>
                            <option value="textile shops">Textile Shops</option>
                            <option value="jewelry stores">Jewelry Stores</option>
                            <option value="mobile shops">Mobile Shops</option>
                            <option value="auto repair">Auto Repair Shops</option>
                            <option value="dentists">Dentists</option>
                            <option value="lawyers">Lawyers</option>
                            <option value="chartered accountants">Chartered Accountants</option>
                            <option value="travel agencies">Travel Agencies</option>
                            <option value="taxi services">Taxi Services</option>
                            <option value="courier services">Courier Services</option>
                            <option value="custom">üîç Custom keyword</option>
                        </select>
                        <p class="input-hint">Categories align to Google Maps search suggestions for faster discovery.</p>
                    </div>
                    <div class="field-group" id="customKeywordDiv" style="display: none;">
                        <label for="custom_keyword" class="field-label">
                            <span><i class="fa-solid fa-keyboard me-1"></i> Custom search keyword</span>
                        </label>
                        <input type="text" class="form-control" id="custom_keyword" name="custom_keyword" placeholder="e.g., vegan bakeries, digital marketing agencies" maxlength="100" aria-describedby="custom-keyword-hint">
                        <p id="custom-keyword-hint" class="input-hint">Perfect when presets do not cover your niche.</p>
                    </div>
                    <div class="field-group">
                        <label for="results_per_area" class="field-label">
                            <span><i class="fa-solid fa-list-ol me-1"></i> Results per area</span>
                            <span class="tooltip-icon" role="img" data-bs-toggle="tooltip" title="Enter how many locations to capture per neighbourhood. Set 9999 to harvest everything available." aria-hidden="true">?</span>
                        </label>
                        <input type="number" class="form-control" id="results_per_area" name="results_per_area" value="9999" min="1" required aria-describedby="results-per-area-hint">
                        <p id="results-per-area-hint" class="input-hint">We recommend a high ceiling to avoid missing late list entries.</p>
                    </div>
                    <div class="field-group">
                        <label for="output_file" class="field-label">
                            <span><i class="fa-solid fa-file-csv me-1"></i> Output file</span>
                        </label>
                        <input type="text" class="form-control" id="output_file" name="output_file" value="chennai-results.csv" aria-describedby="output-file-note">
                        <p id="output-file-note" class="input-hint">CSV downloads arrive in the history tab once the scrape wraps.</p>
                    </div>
                </div>

                <div id="cacheSection" class="cache-card" style="display: none;" aria-live="polite">
                    <div class="d-flex flex-column flex-md-row gap-2 align-items-start align-items-md-center">
                        <i class="fa-solid fa-database"></i>
                        <div>
                            <strong>Resume available</strong>
                            <p class="mb-0">We found a cached Chennai session for <span id="cacheKeyword">‚Äî</span>.</p>
                        </div>
                    </div>
                    <div class="cache-card__meta">
                        <div><strong>Output:</strong> <span id="cacheFilename">‚Äî</span></div>
                        <div><strong>Progress:</strong> <span id="cacheProgress">‚Äî</span></div>
                    </div>
                    <div class="d-flex flex-wrap gap-2">
                        <button type="button" class="btn btn-primary btn-sm" onclick="resumeScraping()">
                            <i class="fa-solid fa-rotate"></i>
                            <span class="ms-2">Resume cached job</span>
                        </button>
                        <button type="button" class="btn btn-soft btn-sm" onclick="document.getElementById('append_mode').checked = true;">
                            Keep append mode on
                        </button>
                    </div>
                </div>
            </section>

            <section class="form-section" aria-labelledby="area-selection-heading">
                <header class="section-header">
                    <div>
                        <p class="section-kicker">Step 2</p>
                        <h2 id="area-selection-heading" class="section-title">Choose your Chennai neighbourhoods</h2>
                        <p class="section-meta mb-0">Group neighbourhoods by region, or select them all for comprehensive coverage.</p>
                    </div>
                </header>

                <div class="area-toolbar">
                    <span class="text-muted">Pick as many neighbourhoods as you need ‚Äì the scraper flows through them sequentially.</span>
                    <div class="area-toolbar__actions">
                        <button type="button" class="btn btn-soft btn-sm" onclick="selectAll()">
                            <i class="fa-solid fa-check-double"></i>
                            <span class="ms-1">Select all</span>
                        </button>
                        <button type="button" class="btn btn-soft btn-sm" onclick="deselectAll()">
                            <i class="fa-solid fa-xmark"></i>
                            <span class="ms-1">Clear selection</span>
                        </button>
                    </div>
                </div>

                <div class="area-scroll-panel mt-3">
                    <ul class="nav nav-tabs mb-3" id="areaTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="central-tab" data-bs-toggle="tab" data-bs-target="#central" type="button" role="tab"> <i class="fas fa-building"></i> Central </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="south-tab" data-bs-toggle="tab" data-bs-target="#south" type="button" role="tab"> <i class="fas fa-leaf"></i> South </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="north-tab" data-bs-toggle="tab" data-bs-target="#north" type="button" role="tab"> <i class="fas fa-industry"></i> North </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="west-tab" data-bs-toggle="tab" data-bs-target="#west" type="button" role="tab"> <i class="fas fa-home"></i> West </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="special-tab" data-bs-toggle="tab" data-bs-target="#special" type="button" role="tab"> <i class="fas fa-star"></i> Special Areas </button>
                        </li>
                    </ul>
                    <div class="tab-content" id="areaTabsContent">
                        <div class="tab-pane fade show active" id="central" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-primary"><i class="fas fa-building"></i> Central Chennai</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="T. Nagar" id="tnagar"><label class="form-check-label" for="tnagar">T. Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Anna Nagar" id="annanagar"><label class="form-check-label" for="annanagar">Anna Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Vadapalani" id="vadapalani"><label class="form-check-label" for="vadapalani">Vadapalani</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kodambakkam" id="kodambakkam"><label class="form-check-label" for="kodambakkam">Kodambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Nungambakkam" id="nungambakkam"><label class="form-check-label" for="nungambakkam">Nungambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Egmore" id="egmore"><label class="form-check-label" for="egmore">Egmore</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Chetpet" id="chetpet"><label class="form-check-label" for="chetpet">Chetpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kilpauk" id="kilpauk"><label class="form-check-label" for="kilpauk">Kilpauk</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Purasawalkam" id="purasawalkam"><label class="form-check-label" for="purasawalkam">Purasawalkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thousand Lights" id="thousandlights"><label class="form-check-label" for="thousandlights">Thousand Lights</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Aminjikarai" id="aminjikarai"><label class="form-check-label" for="aminjikarai">Aminjikarai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Arumbakkam" id="arumbakkam"><label class="form-check-label" for="arumbakkam">Arumbakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Chepauk" id="chepauk"><label class="form-check-label" for="chepauk">Chepauk</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Chintadripet" id="chintadripet"><label class="form-check-label" for="chintadripet">Chintadripet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Choolaimedu" id="choolaimedu"><label class="form-check-label" for="choolaimedu">Choolaimedu</label></div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-primary"><i class="fas fa-building"></i> Central Chennai (cont.)</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Gopalapuram" id="gopalapuram"><label class="form-check-label" for="gopalapuram">Gopalapuram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Koyambedu" id="koyambedu"><label class="form-check-label" for="koyambedu">Koyambedu</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mandaveli" id="mandaveli"><label class="form-check-label" for="mandaveli">Mandaveli</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Nandanam" id="nandanam"><label class="form-check-label" for="nandanam">Nandanam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Park Town" id="parktown"><label class="form-check-label" for="parktown">Park Town</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pudupet" id="pudupet"><label class="form-check-label" for="pudupet">Pudupet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Royapettah" id="royapettah"><label class="form-check-label" for="royapettah">Royapettah</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Santhome" id="santhome"><label class="form-check-label" for="santhome">Santhome</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Shenoy Nagar" id="shenoynagar"><label class="form-check-label" for="shenoynagar">Shenoy Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Teynampet" id="teynampet"><label class="form-check-label" for="teynampet">Teynampet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Vepery" id="vepery"><label class="form-check-label" for="vepery">Vepery</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Abiramapuram" id="abiramapuram"><label class="form-check-label" for="abiramapuram">Abiramapuram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Alwarpet" id="alwarpet"><label class="form-check-label" for="alwarpet">Alwarpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="CIT Nagar" id="citnagar"><label class="form-check-label" for="citnagar">CIT Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="ICF Colony" id="icfcolony"><label class="form-check-label" for="icfcolony">ICF Colony</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="R.A. Puram (Raja Annamalai Puram)" id="rapuram"><label class="form-check-label" for="rapuram">R.A. Puram (Raja Annamalai Puram)</label></div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="south" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-success"><i class="fas fa-leaf"></i> South Chennai</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Adyar" id="adyar"><label class="form-check-label" for="adyar">Adyar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Velachery" id="velachery"><label class="form-check-label" for="velachery">Velachery</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Tambaram" id="tambaram"><label class="form-check-label" for="tambaram">Tambaram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Guindy" id="guindy"><label class="form-check-label" for="guindy">Guindy</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pallikaranai" id="pallikaranai"><label class="form-check-label" for="pallikaranai">Pallikaranai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mylapore" id="mylapore"><label class="form-check-label" for="mylapore">Mylapore</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Besant Nagar" id="besantnagar"><label class="form-check-label" for="besantnagar">Besant Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiruvanmiyur" id="thiruvanmiyur"><label class="form-check-label" for="thiruvanmiyur">Thiruvanmiyur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Sholinganallur" id="sholinganallur"><label class="form-check-label" for="sholinganallur">Sholinganallur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="OMR" id="omr"><label class="form-check-label" for="omr">OMR (Old Mahabalipuram Road)</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Perungudi" id="perungudi"><label class="form-check-label" for="perungudi">Perungudi</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Taramani" id="taramani"><label class="form-check-label" for="taramani">Taramani</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Adambakkam" id="adambakkam"><label class="form-check-label" for="adambakkam">Adambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Injambakkam" id="injambakkam"><label class="form-check-label" for="injambakkam">Injambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Keelkattalai" id="keelkattalai"><label class="form-check-label" for="keelkattalai">Keelkattalai</label></div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-success"><i class="fas fa-leaf"></i> South Chennai (cont.)</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kottivakkam" id="kottivakkam"><label class="form-check-label" for="kottivakkam">Kottivakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kotturpuram" id="kotturpuram"><label class="form-check-label" for="kotturpuram">Kotturpuram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kovilambakkam" id="kovilambakkam"><label class="form-check-label" for="kovilambakkam">Kovilambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Madipakkam" id="madipakkam"><label class="form-check-label" for="madipakkam">Madipakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Manapakkam" id="manapakkam"><label class="form-check-label" for="manapakkam">Manapakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Nanganallur" id="nanganallur"><label class="form-check-label" for="nanganallur">Nanganallur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Neelankarai" id="neelankarai"><label class="form-check-label" for="neelankarai">Neelankarai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Palavakkam" id="palavakkam"><label class="form-check-label" for="palavakkam">Palavakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Perumbakkam" id="perumbakkam"><label class="form-check-label" for="perumbakkam">Perumbakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Sembakkam" id="sembakkam"><label class="form-check-label" for="sembakkam">Sembakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Selaiyur" id="selaiyur"><label class="form-check-label" for="selaiyur">Selaiyur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Sithalapakkam" id="sithalapakkam"><label class="form-check-label" for="sithalapakkam">Sithalapakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="St. Thomas Mount" id="stthomasmount"><label class="form-check-label" for="stthomasmount">St. Thomas Mount</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ullagaram-Puzhuthivakkam" id="ullagrampuzhuthivakkam"><label class="form-check-label" for="ullagrampuzhuthivakkam">Ullagaram-Puzhuthivakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Guindy Industrial Estate" id="guindyindustrial"><label class="form-check-label" for="guindyindustrial">Guindy Industrial Estate</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kottur" id="kottur"><label class="form-check-label" for="kottur">Kottur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kovur" id="kovur"><label class="form-check-label" for="kovur">Kovur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="MEPZ (Madras Export Processing Zone)" id="mepz"><label class="form-check-label" for="mepz">MEPZ (Madras Export Processing Zone)</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Nanmangalam" id="nanmangalam"><label class="form-check-label" for="nanmangalam">Nanmangalam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Puzhuthivakkam" id="puzhuthivakkam"><label class="form-check-label" for="puzhuthivakkam">Puzhuthivakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="SIPCOT IT Park" id="sipcotitpark"><label class="form-check-label" for="sipcotitpark">SIPCOT IT Park</label></div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="north" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-info"><i class="fas fa-industry"></i> North Chennai</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ambattur" id="ambattur"><label class="form-check-label" for="ambattur">Ambattur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Avadi" id="avadi"><label class="form-check-label" for="avadi">Avadi</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Red Hills" id="redhills"><label class="form-check-label" for="redhills">Red Hills</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Madhavaram" id="madhavaram"><label class="form-check-label" for="madhavaram">Madhavaram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Perambur" id="perambur"><label class="form-check-label" for="perambur">Perambur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kolathur" id="kolathur"><label class="form-check-label" for="kolathur">Kolathur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Villivakkam" id="villivakkam"><label class="form-check-label" for="villivakkam">Villivakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thirumullaivoyal" id="thirumullaivoyal"><label class="form-check-label" for="thirumullaivoyal">Thirumullaivoyal</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Poonamallee" id="poonamallee"><label class="form-check-label" for="poonamallee">Poonamallee</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Manali" id="manali"><label class="form-check-label" for="manali">Manali</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ayanavaram" id="ayanavaram"><label class="form-check-label" for="ayanavaram">Ayanavaram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Choolai" id="choolai"><label class="form-check-label" for="choolai">Choolai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ennore" id="ennore"><label class="form-check-label" for="ennore">Ennore</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Korattur" id="korattur"><label class="form-check-label" for="korattur">Korattur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Korukkupet" id="korukkupet"><label class="form-check-label" for="korukkupet">Korukkupet</label></div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-info"><i class="fas fa-industry"></i> North Chennai (cont.)</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="MKB Nagar (Vyasarpadi)" id="mkbnagar"><label class="form-check-label" for="mkbnagar">MKB Nagar (Vyasarpadi)</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Moolakadai" id="moolakadai"><label class="form-check-label" for="moolakadai">Moolakadai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Old Washermanpet" id="oldwashermanpet"><label class="form-check-label" for="oldwashermanpet">Old Washermanpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Padi" id="padi"><label class="form-check-label" for="padi">Padi</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pulianthope" id="pulianthope"><label class="form-check-label" for="pulianthope">Pulianthope</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Royapuram" id="royapuram"><label class="form-check-label" for="royapuram">Royapuram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Sowcarpet" id="sowcarpet"><label class="form-check-label" for="sowcarpet">Sowcarpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Tondiarpet" id="tondiarpet"><label class="form-check-label" for="tondiarpet">Tondiarpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Vyasarpadi" id="vyasarpadi"><label class="form-check-label" for="vyasarpadi">Vyasarpadi</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Washermanpet" id="washermanpet"><label class="form-check-label" for="washermanpet">Washermanpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ambattur Industrial Estate" id="ambatturindustrial"><label class="form-check-label" for="ambatturindustrial">Ambattur Industrial Estate</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Madhavaram Milk Colony" id="madhavaramcolony"><label class="form-check-label" for="madhavaramcolony">Madhavaram Milk Colony</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiruvottiyur" id="thiruvottiyur"><label class="form-check-label" for="thiruvottiyur">Thiruvottiyur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiruninravur" id="thiruninravur"><label class="form-check-label" for="thiruninravur">Thiruninravur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="V.O.C. Nagar" id="vocnagar"><label class="form-check-label" for="vocnagar">V.O.C. Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Jamalia" id="jamalia"><label class="form-check-label" for="jamalia">Jamalia</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiru. Vi. Ka. Nagar" id="thiruvikanagar"><label class="form-check-label" for="thiruvikanagar">Thiru. Vi. Ka. Nagar</label></div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="west" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-warning"><i class="fas fa-home"></i> West Chennai</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Porur" id="porur"><label class="form-check-label" for="porur">Porur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Chromepet" id="chromepet"><label class="form-check-label" for="chromepet">Chromepet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pallavaram" id="pallavaram"><label class="form-check-label" for="pallavaram">Pallavaram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ashok Nagar" id="ashoknagar"><label class="form-check-label" for="ashoknagar">Ashok Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="KK Nagar" id="kknagar"><label class="form-check-label" for="kknagar">KK Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mogappair" id="mogappair"><label class="form-check-label" for="mogappair">Mogappair</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mugalivakkam" id="mugalivakkam"><label class="form-check-label" for="mugalivakkam">Mugalivakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Valasaravakkam" id="valasaravakkam"><label class="form-check-label" for="valasaravakkam">Valasaravakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Virugambakkam" id="virugambakkam"><label class="form-check-label" for="virugambakkam">Virugambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ambattur Estate" id="ambatturestate"><label class="form-check-label" for="ambatturestate">Ambattur Estate</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Gerugambakkam" id="gerugambakkam"><label class="form-check-label" for="gerugambakkam">Gerugambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Iyyappanthangal" id="iyyappanthangal"><label class="form-check-label" for="iyyappanthangal">Iyyappanthangal</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kattupakkam" id="kattupakkam"><label class="form-check-label" for="kattupakkam">Kattupakkam</label></div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-warning"><i class="fas fa-home"></i> West Chennai (cont.)</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Maduravoyal" id="maduravoyal"><label class="form-check-label" for="maduravoyal">Maduravoyal</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ramapuram" id="ramapuram"><label class="form-check-label" for="ramapuram">Ramapuram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Vadaperumbakkam" id="vadaperumbakkam"><label class="form-check-label" for="vadaperumbakkam">Vadaperumbakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Vanagaram" id="vanagaram"><label class="form-check-label" for="vanagaram">Vanagaram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ayyanavaram" id="ayyanavaram"><label class="form-check-label" for="ayyanavaram">Ayyanavaram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Ayapakkam" id="ayapakkam"><label class="form-check-label" for="ayapakkam">Ayapakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Konnur" id="konnur"><label class="form-check-label" for="konnur">Konnur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mannurpet" id="mannurpet"><label class="form-check-label" for="mannurpet">Mannurpet</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mogappair East" id="mogappaireast"><label class="form-check-label" for="mogappaireast">Mogappair East</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mogappair West" id="mogappairwest"><label class="form-check-label" for="mogappairwest">Mogappair West</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Nolambur" id="nolambur"><label class="form-check-label" for="nolambur">Nolambur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Senneerkuppam" id="senneerkuppam"><label class="form-check-label" for="senneerkuppam">Senneerkuppam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiruverkadu" id="thiruverkadu-west"><label class="form-check-label" for="thiruverkadu-west">Thiruverkadu</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Valasaravakkam Extension" id="valasaravakkamext"><label class="form-check-label" for="valasaravakkamext">Valasaravakkam Extension</label></div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="special" role="tabpanel">
                            <div class="row">
                                <div class="col-md-3">
                                    <h6 class="text-danger"><i class="fas fa-star"></i> IT Corridor</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thoraipakkam" id="thoraipakkam"><label class="form-check-label" for="thoraipakkam">Thoraipakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Navalur" id="navalur"><label class="form-check-label" for="navalur">Navalur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Siruseri" id="siruseri"><label class="form-check-label" for="siruseri">Siruseri</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kelambakkam" id="kelambakkam"><label class="form-check-label" for="kelambakkam">Kelambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Medavakkam" id="medavakkam"><label class="form-check-label" for="medavakkam">Medavakkam</label></div>
                                </div>
                                <div class="col-md-3">
                                    <h6 class="text-secondary"><i class="fas fa-map"></i> Outer Areas</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Chengalpattu" id="chengalpattu"><label class="form-check-label" for="chengalpattu">Chengalpattu</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Kancheepuram" id="kancheepuram"><label class="form-check-label" for="kancheepuram">Kancheepuram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Maraimalai Nagar" id="maraimalainagar"><label class="form-check-label" for="maraimalainagar">Maraimalai Nagar</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Vandalur" id="vandalur"><label class="form-check-label" for="vandalur">Vandalur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Urapakkam" id="urapakkam"><label class="form-check-label" for="urapakkam">Urapakkam</label></div>
                                </div>
                                <div class="col-md-3">
                                    <h6 class="text-dark"><i class="fas fa-city"></i> City Centre</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="George Town" id="georgetown"><label class="form-check-label" for="georgetown">George Town</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Parrys Corner" id="parrysc"><label class="form-check-label" for="parrysc">Parrys Corner</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mount Road" id="mountroad"><label class="form-check-label" for="mountroad">Mount Road</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Triplicane" id="triplicane"><label class="form-check-label" for="triplicane">Triplicane</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Fort St. George" id="fortstgeorge"><label class="form-check-label" for="fortstgeorge">Fort St. George</label></div>
                                </div>
                                <div class="col-md-3">
                                    <h6 class="text-muted"><i class="fas fa-plus"></i> Additional Areas</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="ECR" id="ecr"><label class="form-check-label" for="ecr">ECR (East Coast Road)</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="GST Road" id="gstroad"><label class="form-check-label" for="gstroad">GST Road</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Rajiv Gandhi Salai" id="rajivgandhisalai"><label class="form-check-label" for="rajivgandhisalai">Rajiv Gandhi Salai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mahindra City" id="mahindra"><label class="form-check-label" for="mahindra">Mahindra City</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mahabalipuram" id="mahabalipuram"><label class="form-check-label" for="mahabalipuram">Mahabalipuram</label></div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-3">
                                    <h6 class="text-purple"><i class="fas fa-map-signs"></i> Suburban Areas</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Annanur" id="annanur"><label class="form-check-label" for="annanur">Annanur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Guduvancheri" id="guduvancheri"><label class="form-check-label" for="guduvancheri">Guduvancheri</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Irumbuliyur" id="irumbuliyur"><label class="form-check-label" for="irumbuliyur">Irumbuliyur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Madambakkam" id="madambakkam"><label class="form-check-label" for="madambakkam">Madambakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Manali New Town" id="manalinewtown"><label class="form-check-label" for="manalinewtown">Manali New Town</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Mathur" id="mathur"><label class="form-check-label" for="mathur">Mathur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Moulivakkam" id="moulivakkam"><label class="form-check-label" for="moulivakkam">Moulivakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Oragadam" id="oragadam"><label class="form-check-label" for="oragadam">Oragadam</label></div>
                                </div>
                                <div class="col-md-3">
                                    <h6 class="text-brown"><i class="fas fa-road"></i> Extended Areas</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pammal" id="pammal"><label class="form-check-label" for="pammal">Pammal</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pattabiram" id="pattabiram"><label class="form-check-label" for="pattabiram">Pattabiram</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pattaravakkam" id="pattaravakkam"><label class="form-check-label" for="pattaravakkam">Pattaravakkam</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pazhavanthangal" id="pazhavanthangal"><label class="form-check-label" for="pazhavanthangal">Pazhavanthangal</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Perungalathur" id="perungalathur"><label class="form-check-label" for="perungalathur">Perungalathur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Pozhichalur" id="pozhichalur"><label class="form-check-label" for="pozhichalur">Pozhichalur</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Singaperumal Koil" id="singaperumalkoil"><label class="form-check-label" for="singaperumalkoil">Singaperumal Koil</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Sriperumbudur" id="sriperumbudur"><label class="form-check-label" for="sriperumbudur">Sriperumbudur</label></div>
                                </div>
                                <div class="col-md-3">
                                    <h6 class="text-teal"><i class="fas fa-temple-hindu"></i> Temple Areas</h6>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thirumazhisai" id="thirumazhisai"><label class="form-check-label" for="thirumazhisai">Thirumazhisai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiruneermalai" id="thiruneermalai"><label class="form-check-label" for="thiruneermalai">Thiruneermalai</label></div>
                                    <div class="form-check"><input class="form-check-input area-checkbox" type="checkbox" name="areas" value="Thiruverkadu" id="thiruverkadu"><label class="form-check-label" for="thiruverkadu">Thiruverkadu</label></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-3 align-items-center mt-3">
                    <div class="col-lg-8">
                        <p class="mb-0 text-muted">Selections are saved instantly‚Äîuse select all to cover every neighbourhood or focus on clusters for rapid outreach lists.</p>
                    </div>
                    <div class="col-lg-4">
                        <div class="metrics-card text-center">
                            <div class="metrics-card__label text-uppercase">Areas loaded</div>
                            <div class="metrics-card__value"><span id="totalAreaCount">Loading...</span></div>
                            <hr class="my-3">
                            <div class="metrics-card__label text-uppercase">Your selection</div>
                            <div class="metrics-card__value"><span id="selectedCount">0 areas selected</span></div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="form-section" aria-labelledby="chennai-output-heading">
                <header class="section-header">
                    <div>
                        <p class="section-kicker">Step 3</p>
                        <h2 id="chennai-output-heading" class="section-title">Output &amp; performance options</h2>
                        <p class="section-meta mb-0">Keep files tidy, control resume behaviour, and preview upcoming worker controls.</p>
                    </div>
                    <span class="section-optional">Optional</span>
                </header>

                <div class="field-grid">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="append_mode" name="append_mode">
                        <label class="form-check-label" for="append_mode">
                            <i class="fa-solid fa-layer-group me-1"></i> Append to existing CSV
                        </label>
                        <p class="input-hint">Enabled automatically when resuming from cache. Keeps historical rows intact.</p>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="fast_append" name="fast_append">
                        <label class="form-check-label" for="fast_append">
                            <i class="fa-solid fa-bolt me-1"></i> Ultra-fast append (skip duplicate checks)
                        </label>
                        <p class="input-hint text-warning mb-0"><strong>Heads-up:</strong> use only when you are certain there will be no duplicates.</p>
                    </div>
                </div>

                <div class="field-group">
                    <label class="field-label" for="chennai-concurrency-preview">
                        <span><i class="fa-solid fa-users-gear me-1"></i> Concurrent workers</span>
                        <span class="tooltip-icon" role="img" data-bs-toggle="tooltip" title="Parallel browser workers to accelerate scrapes are arriving soon." aria-hidden="true">?</span>
                    </label>
                    <input type="text" id="chennai-concurrency-preview" value="Coming soon" disabled aria-disabled="true">
                    <p class="input-hint">Performance upgrades will unlock here shortly.</p>
                </div>

                <div class="form-section__footer">
                    <span class="badge-soft" id="selectedCountBadge">0 areas selected</span>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fa-solid fa-play me-2"></i>Start Chennai scraping
                        </button>
                    </div>
                </div>
            </section>
        </form>
    </div>

    <aside class="guided-layout__secondary">
        <div class="support-panel">
            <div class="support-panel__card">
                <h3><i class="fa-solid fa-lightbulb me-2"></i>Workflow tips</h3>
                <p class="mb-2">Combine coastal, northern, and suburban tabs for balanced outreach lists. Save time with select all, then deselect outliers.</p>
                <p class="mb-0">Focus styles and tab controls are fully keyboard accessible. Use the space bar to toggle individual areas.</p>
            </div>
            <div class="support-panel__card">
                <h3><i class="fa-solid fa-circle-nodes me-2"></i>Chennai data coverage</h3>
                <ul class="mb-0 ps-3">
                    <li>Over 150 curated neighbourhoods with growth corridors included.</li>
                    <li>Cache resume keeps partially completed districts from repeating.</li>
                    <li>Live notifications surface validation issues before scraping begins.</li>
                </ul>
            </div>
        </div>
    </aside>
</div>
{% endblock %}

{% block scripts %}
<script>
(function() {
    const AREA_SELECTOR = '.area-checkbox';
    const appendMode = document.getElementById('append_mode');
    const fastAppend = document.getElementById('fast_append');
    const cacheSection = document.getElementById('cacheSection');
    const cacheKeyword = document.getElementById('cacheKeyword');
    const cacheFilename = document.getElementById('cacheFilename');
    const cacheProgress = document.getElementById('cacheProgress');
    const selectedCountText = document.getElementById('selectedCount');
    const totalAreaCountText = document.getElementById('totalAreaCount');
    const selectedCountBadge = document.getElementById('selectedCountBadge');
    const businessTypeSelect = document.getElementById('business_type');
    const customKeywordDiv = document.getElementById('customKeywordDiv');
    const customKeywordInput = document.getElementById('custom_keyword');

    function setCacheSectionVisible(visible) {
        if (!cacheSection) return;
        cacheSection.style.display = visible ? 'grid' : 'none';
        cacheSection.setAttribute('aria-hidden', visible ? 'false' : 'true');
    }

    function formatSelectionCount(count) {
        return `${count} area${count === 1 ? '' : 's'} selected`;
    }

    function updateSelectedCount() {
        const selected = document.querySelectorAll(`${AREA_SELECTOR}:checked`).length;
        const message = formatSelectionCount(selected);
        if (selectedCountText) {
            selectedCountText.textContent = message;
        }
        if (selectedCountBadge) {
            selectedCountBadge.textContent = message;
        }
    }

    function updateTotalAreaCount() {
        const total = document.querySelectorAll(AREA_SELECTOR).length;
        if (totalAreaCountText) {
            totalAreaCountText.textContent = total;
        }
    }

    window.selectAll = function selectAll() {
        document.querySelectorAll(AREA_SELECTOR).forEach((checkbox) => {
            checkbox.checked = true;
        });
        updateSelectedCount();
        showNotification('All Chennai areas selected.', 'info', { duration: 2500 });
    };

    window.deselectAll = function deselectAll() {
        document.querySelectorAll(AREA_SELECTOR).forEach((checkbox) => {
            checkbox.checked = false;
        });
        updateSelectedCount();
        showNotification('Selection cleared.', 'info', { duration: 2500 });
    };

    window.toggleCustomKeyword = function toggleCustomKeyword() {
        if (!businessTypeSelect) {
            return;
        }
        const useCustom = businessTypeSelect.value === 'custom';
        if (customKeywordDiv) {
            customKeywordDiv.style.display = useCustom ? 'grid' : 'none';
        }
        if (customKeywordInput) {
            customKeywordInput.required = useCustom;
            if (!useCustom) {
                customKeywordInput.value = '';
            }
        }
    };

    function handleAreaChange(event) {
        if (event.target && event.target.matches(AREA_SELECTOR)) {
            updateSelectedCount();
        }
    }

    function checkForCache() {
        fetch('/check_cache')
            .then((response) => response.json())
            .then((data) => {
                if (data.has_cache) {
                    cacheKeyword.textContent = data.keyword || 'Unknown query';
                    cacheFilename.textContent = data.filename || 'chennai-results.csv';
                    cacheProgress.textContent = `${data.completed_count || 0} businesses captured`;
                    setCacheSectionVisible(true);
                    appendMode.checked = true;
                    appendMode.disabled = false;
                    showNotification('Cached Chennai session detected. Ready to resume.', 'info');
                } else {
                    setCacheSectionVisible(false);
                }
            })
            .catch(() => {
                setCacheSectionVisible(false);
            });
    }

    window.resumeScraping = function resumeScraping() {
        appendMode.checked = true;
        document.getElementById('chennaiForm').submit();
    };

    function validateForm(event) {
        const selectedAreas = document.querySelectorAll(`${AREA_SELECTOR}:checked`).length;
        const businessType = businessTypeSelect.value;
        const customKeyword = customKeywordInput.value.trim();

        if (selectedAreas === 0) {
            event.preventDefault();
            showNotification('Select at least one Chennai area before starting.', 'error');
            return false;
        }

        if (!businessType) {
            event.preventDefault();
            showNotification('Choose a business category or switch to a custom keyword.', 'error');
            businessTypeSelect.focus();
            return false;
        }

        if (businessType === 'custom' && !customKeyword) {
            event.preventDefault();
            showNotification('Enter a custom keyword to continue.', 'error');
            customKeywordInput.focus();
            return false;
        }

        return true;
    }

    document.addEventListener('change', handleAreaChange);

    document.addEventListener('DOMContentLoaded', () => {
        updateTotalAreaCount();
        updateSelectedCount();
        toggleCustomKeyword();
        checkForCache();
    });

    if (fastAppend) {
        fastAppend.addEventListener('change', function () {
            if (this.checked) {
                appendMode.checked = true;
                appendMode.disabled = true;
                showNotification('Ultra-fast append enabled. Duplicate checks are skipped.', 'warning', { duration: 6000 });
            } else {
                appendMode.disabled = false;
            }
        });
    }

    const form = document.getElementById('chennaiForm');
    if (form) {
        form.addEventListener('submit', function (event) {
            if (!validateForm(event)) {
                return;
            }
            const submitButton = form.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Preparing‚Ä¶';
                submitButton.disabled = true;
            }
        });
    }
})();
</script>
{% endblock %}
